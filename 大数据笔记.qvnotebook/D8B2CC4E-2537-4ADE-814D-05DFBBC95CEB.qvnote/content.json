{
  "title": "06-Zookeeper-0201-zk的选举",
  "cells": [
    {
      "type": "markdown",
      "data": "```shell\r\n\r\nleader推选过程(最小号选举法)\r\n-------------------\r\n\t1.所有节点在同一目录下创建临时序列节点。\r\n\t2.节点下会生成/xxx/xx000000001等节点。\r\n\t3.序号最小的节点就是leader，其余就是follower.\r\n\t4.每个节点观察小于自己的上一个节点的主机。(注册观察者)\r\n\t5.如果leader挂了，对应znode删除了。\r\n\t6.观察者收到通知。如果没有没有比自己还小的，那么自己就是leader，如果有比自己小的，那么再观察小于自己的那个节点\r\n\t\r\n```\r\n\r\n\r\n## 1,zk的选举机制\r\n\r\n*zk的选举机制简单来讲就是一个序列节点。zk的序列节点的意思就是节点和mysql的自增是一样的，每次都会进行增加。具体如下：*\r\n\r\n* 01，所有的节点都会在同一个目录下创建相同的序列节点。先启动的说明连接速度快，创建的比较早，序号比较小，后来创建的序号比较大。\r\n\r\n* 02, 那么序号最小的因为速度最快，所以成为leader。然后其余的节点依次注册观察者，观察序号小于自己的上一个节点。\r\n\r\n* 03，一旦leader挂掉，那么接收到通知的节点在看到没有序号比自己小的节点，就理所当然的成为leader。\r\n\r\n* 04，如果其他节点挂掉，那么接受通知的节点会重新注册观察者，观察存活中的小于自己的上一个节点\r\n\r\n"
    }
  ]
}