{
  "title": "03-Hadoop-0702-Counter",
  "cells": [
    {
      "type": "markdown",
      "data": "* `参考  275/756  [O'REILLY]Hadoop.The.Definitive.Guide.4th.Edition.2015.3`\n\n* 通过上下文调用，获取Counter，然后可以输入相关的信息。如果在相同的节点上重复调用，个数就会加1，如下\n\n* 这个主要用来debug的时候查看服务器和mapper以及reducer的节点信息等\n\n```java\ncontext.getCounter(\"Reducer\", IMTrackerUtils.getInfo(this, \"IMWordCountReducer\")).increment(1);\n```\n\n* 上面使用的工具类IMTrackerUtils如下:\n\n```java\npackage im.ivanl001.bigData.IMUtils;\n\nimport java.lang.management.ManagementFactory;\nimport java.net.InetAddress;\nimport java.net.UnknownHostException;\n\n/**\n * #author      : ivanl001\n * #creator     : 2018-10-24 17:54\n * #description : 调用的方法的追踪信息\n * : hostname + pid + tid + oid + methodName\n * 主机 + 进程 + 线程 + 对象 + 方法名\n *\n *  不知道为什么，这个方法慢的出奇，所以暂时不能用，先放在这里，之后有用到再研究\n *\n **/\npublic class IMTrackerUtils {\n\n    public static String getInfo(Object o, String msg) {\n        return getHostName() + \" : \" + getPid() + \" : \" + getTid() + \" : \" + getOid(o) + \" : \" + msg;\n    }\n\n    //得到主机名 ex：BooldeMacBook-Pro.local\n    public static String getHostName(){\n        try {\n            return InetAddress.getLocalHost().getHostName();\n        } catch (UnknownHostException e) {\n            e.printStackTrace();\n        }\n        return null;\n    }\n\n    //得到进程号：ex：10497\n    //注：ManagementFactory.getRuntimeMXBean().getName()可以直接得到进程号@主机号，ex：10497@BooldeMacBook-Pro.local：\n    public static String getPid(){\n        String info = ManagementFactory.getRuntimeMXBean().getName();\n        return info.substring(0,info.indexOf(\"@\"));\n    }\n\n    //得到线程\n    public static String getTid(){\n        String tid = Thread.currentThread().getName();\n        return tid;\n    }\n\n    //得到对象\n    public static String getOid(Object o){\n        //String oid = o.toString();\n        String sname = o.getClass().getSimpleName();\n        return sname + \"@\" + o.hashCode();\n    }\n\n    //根据一个对象获取这个对象的全路径\n    /*public static String getOid_full(Object o) {\n        String oid = o.\n    }*/\n\n}\n\n```"
    }
  ]
}