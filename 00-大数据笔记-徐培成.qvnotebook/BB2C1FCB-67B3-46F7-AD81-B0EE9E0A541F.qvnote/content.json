{
  "title": "03-Hadoop-1011-è¡¨çº§é”åŠæ•°æ®åº“è¯­å¥",
  "cells": [
    {
      "type": "markdown",
      "data": "## 1ï¼Œè¡¨çº§é”\n> é”å®šï¼Œ å“ˆå“ˆï¼Œæ³¨æ„ï¼šå¦‚æžœè¿™é‡Œé”å®šäº†ä¹‹åŽæ²¡æœ‰è§£é”ï¼Œå…¶ä»–çš„æ•°æ®éƒ½æš‚æ—¶æ’ä¸è¿›åŽ»äº†ï¼Œæ‰€ä»¥ç”Ÿäº§çŽ¯å¢ƒåƒä¸‡åˆ«ä¹±æ¥\n\n`lock table users write;`//é”å®šä¹‹åŽå…¶ä»–å®¢æˆ·ç«¯æ˜¯ä¸èƒ½å†™å…¥ï¼Œä¹Ÿä¸èƒ½è¯»å–çš„ï¼Œéœ€è¦ç­‰å¾…\n\n> è§£é”ï¼Œç»“æžœåªèƒ½åœ¨åŠ é”çš„å®¢æˆ·ç«¯ä¸Šè¿›è¡Œ\n\n`unlock tables;`\n"
    },
    {
      "type": "markdown",
      "data": "## 2ï¼Œè¿žæŽ¥æŸ¥è¯¢\n\n* 01ï¼Œ ç¬›å¡å°”ç§¯ï¼Œä¹Ÿå«åšç»„åˆæŸ¥è¯¢,æ²¡æœ‰è¿žæŽ¥æ¡ä»¶ï¼Œè¿™ç§å…¶å®žæ²¡å•¥ç”¨å¤„ï¼Œç”¨ä¸‹é¢çš„ä¸¾ä¾‹æ¥è¯´ï¼Œæ‰€æœ‰çš„ç”¨æˆ·å¯¹åº”æ¯ä¸€æ¡è®¢å•(ä¸ç®¡æ˜¯è°çš„)ï¼Œç„¶åŽæ˜¾ç¤ºå‡ºæ¥ï¼Œæ¯”å¦‚è¯´å››ä¸ªç”¨æˆ·ï¼Œè®¢å•ä¸­ä¸€å…±10æ¡è®¢å•ï¼Œæ‰€ä»¥ä¸€å…±ä¼šå±•ç¤ºå‡ºæ¥40æ¡è®¢å•ï¼Œæ²¡å•¥å®žé™…æ„ä¹‰\n`select a.*, b.* from customers as a, orders as b;`\n\n* 02ï¼Œå†…è¿žæŽ¥æŸ¥è¯¢, è¿™ç§æƒ…å†µä¸‹ï¼Œæ²¡æœ‰è®¢å•çš„å®¢æˆ·å’Œæ²¡æœ‰å®¢æˆ·çš„è®¢å•éƒ½ä¸ä¼šæŸ¥å‡ºæ¥\n`select a.*, b.* from customers as a, orders as b where a.id = b.cid;`\n\n\n* 03ï¼Œå¤–è¿žæŽ¥\n    * å·¦å¤–è¿žæŽ¥ \n    * è¿™æ ·ä¼šä¼˜å…ˆæ˜¾ç¤ºå·¦è¾¹çš„(å°±ç®—å³è¾¹çš„é‚£äº›æ¡ä»¶æ²¡æœ‰å¯¹åº”ä¸Šä¹Ÿä¼šæ˜¾ç¤ºå·¦è¾¹)ï¼Œæ¯”å¦‚è¯´ä¸‹é¢è¿™ä¸ªï¼Œå·¦è¾¹çš„æ˜¯customersè¡¨ï¼Œæ‰€ä»¥æ²¡æœ‰è®¢å•çš„ç”¨æˆ·ä¹Ÿä¼šæ˜¾ç¤ºå‡ºæ¥\n    `select a.*, b.* from customers as a left outer join orders as b on a.id = b.cid;`\n    * å³å¤–è¿žæŽ¥ï¼Œä¼˜å…ˆæ˜¾ç¤ºå³è¾¹çš„ï¼Œè¿™é‡Œå³è¾¹çš„æ˜¯è®¢å•ï¼Œæ‰€ä»¥å°±ç®—è®¢å•æ²¡æœ‰å¯¹åº”ä¸Šçš„ç”¨æˆ·ï¼Œä¹Ÿä¼šæ˜¾ç¤ºå‡ºæ¥ï¼Œå½“ç„¶è®¢å•è‚¯å®šä¼šæœ‰ç”¨æˆ·ï¼Œè¿™é‡Œåªæ˜¯æ¼”ç¤ºç”¨çš„ï¼Œä¸å¿…åœ¨ä¹Žé€»è¾‘ä¸¥è°¨æ€§\n    `select a.*, b.* from customers as a right outer join orders as b on a.id = b.cid;`"
    },
    {
      "type": "markdown",
      "data": "## 3ï¼ŒæŸ¥è¯¢è¯­æ³•\n> select ... from ... where ... group by ... having ... order by ... limit ... for update\n>-------å­—æ®µ-----è¡¨å------æ¡ä»¶--------åˆ†ç»„----ç»„å†…æ¡ä»¶----æŽ’åº---åˆ†é¡µ----é”å®š"
    },
    {
      "type": "markdown",
      "data": "### 3.1ï¼Œ åŽ»é‡ disctinct\n> select distinct price, cid from orders;//è¿™ä¸ªæ˜¯å¯¹ç»„åˆåŽ»é‡ï¼Œè€Œä¸æ˜¯å¯¹å•ä¸€å­—æ®µåŽ»é‡ï¼Œè¿™é‡Œä»£è¡¨æ˜¯ä»·æ ¼å’Œcidéƒ½æ˜¯ä¸€æ ·çš„è¯ç®—æ˜¯é‡å¤"
    },
    {
      "type": "markdown",
      "data": "### 3.2ï¼Œ æ¡ä»¶ where\n> select * from orders where price > 12.25;"
    },
    {
      "type": "markdown",
      "data": "### 3.3, èšåˆæŸ¥è¯¢ï¼šæœ€å¤§å€¼ï¼Œæœ€å°å€¼ï¼Œå¹³å‡å€¼, æ€»å’Œï¼Œä¸ªæ•°\n> select max(price) from orders;\n> select min(price) from orders;\n> select avg(price) from orders;\n> select sum(price) from orders;\n> select count(price) from orders;\n"
    },
    {
      "type": "markdown",
      "data": "### 3.4ï¼Œ åˆ†ç»„ï¼Œ æ¯”å¦‚æŸ¥è¯¢æ¯ä¸ªç”¨æˆ·-è¯¥ç”¨æˆ·è®¢å•çš„æœ€å¤§é‡‘é¢å’Œæœ€å°é‡‘é¢,cidæ˜¯ç”¨æˆ·idï¼Œå¯ä»¥å½“ä½œç”¨æˆ·ç†è§£\n> select cid, max(price) from orders where cid is not null group by cid;\n> select cid, max(price), min(price) from orders where cid is not null  group by cid;\n// æ³¨æ„ï¼šä¸èƒ½è¿™æ ·æŸ¥è¯¢, å› ä¸ºå…ˆåˆ†ç»„ï¼Œåˆ†å®Œç»„ä¹‹åŽï¼Œå¯ä»¥æ±‚æœ€å¤§å€¼ï¼Œæœ€å°å€¼ï¼Œcid(ä¸€ä¸ªç»„é‡Œé¢cidéƒ½æ˜¯ç›¸åŒçš„)ï¼Œä½†æ˜¯ordernoæ˜¯ä¸ä¸€æ ·çš„ï¼Œè¿™æ ·å­æ˜¯ä¸èƒ½å¯¹åº”å‡ºæœ€å¤§é‡‘é¢è®¢å•å·å’Œæœ€å°é‡‘é¢è®¢å•å·çš„å“¦ï¼š\nselect cid, orderno, max(price), min(price) from orders where cid is not null  group by cid;"
    },
    {
      "type": "markdown",
      "data": "### 3.5ï¼Œåˆ†ç»„ä¹‹åŽå†åŠ è¿‡æ»¤æ¡ä»¶ï¼Œæ¯”å¦‚æ•°ä¹‹å‰æ±‚ç”¨æˆ·è®¢å•æœ€å¤§é‡‘é¢ï¼ŒçŽ°åœ¨è¦æ±‚æ˜¾ç¤ºæœ€å¤§é‡‘é¢å¤§äºŽ20çš„\n* ä¸‹é¢çš„è¯­å¥ä¹Ÿå¯ä»¥ä½¿ç”¨åˆ«åå“ˆï¼Œæ‡’ï¼Œä¸æƒ³æ”¹äº†\n> select cid, max(price), min(price) from orders where cid is not null  group by cid having max(price) > 15"
    },
    {
      "type": "markdown",
      "data": "### 3.6ï¼Œè¿‡æ»¤ä¹‹åŽè¿˜è¦æŒ‰ç…§ä»·æ ¼é™åºæŽ’åˆ—\n> select cid, max(price) as max_price, min(price) from orders where cid is not null  group by cid having max_price > 15 order by max_price desc;"
    },
    {
      "type": "markdown",
      "data": "### 3.7, è¿‡æ»¤ä¹‹åŽå°±å‰©ä¸¤æ¡ï¼Œå°±ä¸åˆ†é¡µäº†ï¼Œç›´æŽ¥ç”¨å…¨è®¢å•è¡¨åˆ†é¡µäº†\n> select * from orders limit 3; //å‰3æ¡\n> select * from orders limit 3,3; //ä»Žç¬¬ä¸‰æ¡å¼€å§‹ï¼Œé™åˆ¶ä¸‰æ¡"
    },
    {
      "type": "markdown",
      "data": "### 3.8ï¼Œå­æŸ¥è¯¢, è¿™é‡ŒæŸ¥è¯¢é‚£äº›å®¢æˆ·æ²¡æœ‰è®¢å•\n> select * from customers where id not in (select distinct cid from orders where cid is not null);"
    },
    {
      "type": "markdown",
      "data": "### 3.9, æ¨¡ç³ŠæŸ¥è¯¢\n> select * from customers where name like 'tom%';"
    },
    {
      "type": "markdown",
      "data": "### 3.10, èŒƒå›´æŸ¥è¯¢\n> select * from customers where id in (1,2);\n> select * from customers where id not in (1,2);\n> select * from customers where id between 1 and 3;//è¿™é‡Œæ˜¯é—­åŒºé—´"
    },
    {
      "type": "markdown",
      "data": "### 3.11ï¼ŒåµŒå¥—æŸ¥è¯¢ \n* 01ï¼ŒæŸ¥è¯¢è®¢å•æ•°é‡å¤§äºŽ2çš„æ‰€æœ‰ç”¨æˆ·\n> select * from customers where id in (select cid from orders group by cid having count(cid) > 2);\n* 02,è¿™ä¸ªå¾ˆé‡è¦ï¼šè¦æ±‚ï¼šæŸ¥è¯¢å‡ºç”¨æˆ·ä¿¡æ¯ï¼Œç”¨æˆ·çš„è®¢å•æ•°é‡ï¼Œéœ€è¦è®¢å•æ•°é‡å¤§äºŽ2\n* æŸ¥ä¸å‡ºæ¥ðŸ˜¿\n> "
    },
    {
      "type": "markdown",
      "data": "### 3.12ï¼Œ \n> alter orders add column area int;//æ–°åŠ ä¸ªå­—æ®µ\n* å¯ä»¥åŒæ—¶å¯¹å¤šä¸ªå­—æ®µè¿›è¡Œåˆ†ç»„æŽ’åº\n> select cid, area, count(price) from orders group by cid, area order by cid asc, area desc;\n* è¿˜å¯ä»¥é¡ºä¾¿æ±‚å‡ºæœ€å¤§å€¼æœ€å°å€¼\n> select cid, area, count(price), max(price), min(price) from orders group by cid, area order by cid asc, area desc;"
    },
    {
      "type": "markdown",
      "data": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
    },
    {
      "type": "markdown",
      "data": ""
    }
  ]
}