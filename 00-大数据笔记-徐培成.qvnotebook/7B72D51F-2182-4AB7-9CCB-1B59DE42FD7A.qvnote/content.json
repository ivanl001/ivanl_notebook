{
  "title": "09-Kafka-0109-Kafka和Flume的集成",
  "cells": [
    {
      "type": "markdown",
      "data": "## 1，Kafka作为flume的sink，这个是一般的做法，flume收集数据，Kafka做缓冲\n\n* 01,更改配置文件如下，并重命名为flume-netcat-kafka-conf.properties\n  ```shell\n  # 0, 首先指定三种组件：源,通道,槽\n  agent.sources = r1\n  agent.channels = c1\n  agent.sinks = k1\n  \n  \n  # 1, 定义source相关信息，绑定流入的数据， 并制定输出的方向\n  agent.sources.r1.type = netcat\n  agent.sources.r1.bind = localhost\n  agent.sources.r1.port = 8888\n  agent.sources.r1.channels = c1\n  \n  \n  # 2, 定义channel相关的信息, 这里不需要制定输出，而是让sink指定输入的\n  agent.channels.c1.type = memory\n  \n  \n  # 3, 定义sink相关的信息\n  agent.sinks.k1.channel = c1\n  agent.sinks.k1.type = org.apache.flume.sink.kafka.KafkaSink\n  agent.sinks.k1.kafka.bootstrap.servers = slave01:9092\n  agent.sinks.k1.kafka.topic = mytopic\n  agent.sinks.k1.kafka.flumeBatchSize = 20\n  agent.sinks.k1.kafka.producer.acks = 1\n  ```\n\n* 02,kafka应该是已经启动了的，如果没有启动，请启动kafka\n\n* 03, 使用我们刚才配置的文件启动flume\n  > flume-ng agent -n agent -c conf -f /usr/local/flume/conf/myConf/flume-netcat-kafka-conf.properties -Dflume.root.logger=INFO,console\n\n\n\n\n\n-----\n下面两个不再练习，直接拷贝一下举例的配置文件\n\n## 2, Kafka作为flume的source，这个很少见\n\n  ```shell\n  a1.sources = r1\n  a1.sinks = k1\n  a1.channels = c1\n  \n  a1.sources.r1.type = org.apache.flume.source.kafka.KafkaSource\n  a1.sources.r1.batchSize = 5000\n  a1.sources.r1.batchDurationMillis = 2000\n  a1.sources.r1.kafka.bootstrap.servers = s202:9092\n  a1.sources.r1.kafka.topics = test3\n  a1.sources.r1.kafka.consumer.group.id = g4\n  \n  a1.sinks.k1.type = logger\n  \n  a1.channels.c1.type=memory\n  \n  a1.sources.r1.channels = c1\n  a1.sinks.k1.channel = c1\n  ```\n\n## 3，Kafka作为flume的channel\n  ```shell\n  a1.sources = r1\n  a1.sinks = k1\n  a1.channels = c1\n  \n  a1.sources.r1.type = avro\n  a1.sources.r1.bind = localhost\n  a1.sources.r1.port = 8888\n  \n  a1.sinks.k1.type = logger\n  \n  a1.channels.c1.type = org.apache.flume.channel.kafka.KafkaChannel\n  a1.channels.c1.kafka.bootstrap.servers = s202:9092\n  a1.channels.c1.kafka.topic = test3\n  a1.channels.c1.kafka.consumer.group.id = g6\n  \n  a1.sources.r1.channels = c1\n  a1.sinks.k1.channel = c1\n  ```\n\n"
    }
  ]
}